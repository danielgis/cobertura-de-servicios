{"version":3,"sources":["../../../widgets/DynamicSearchWidgetCunaMas/Widget.js"],"names":["declare","BaseWidget","_WidgetsInTemplateMixin","WidgetManager","QueryTask","Query","Deferred","all","BusyIndicator","Message","jquery","select2","fontAwesome","document","createElement","src","head","appendChild","select2Css","rel","href","isFirstLoad","baseClass","groupSelected","urlLayerSelected","whereDefault","postCreate","inherited","arguments","map","on","executeZoomExtentInitial","bind","showMessageCs","message","type","title","nls","widgetTitle","titleLabel","onClickGroup","evt","indexGroupSelected","Array","from","target","parentNode","children","indexOf","config","groups","find","group","index","buildFormRadioCs","buildFormSearchCs","buildHeaderSearchCs","containerGroupsApCs","classList","toggle","containerFiltersApCs","onClickBack","destroyFormSearchCs","startup","busyIndicator","create","domNode","backgroundOpacity","onOpen","buildMainMenuCs","dojo","query","homeWidget","getInstance","getWidgetsByName","setExtent","homeDijit","extent","sort","a","b","containerGridApCs","innerHTML","length","containerBackApCs","remove","forEach","img","logo","alt","name","add","setAttribute","label","style","color","description","containerImgSelectedApCs","layersForm","makeSelectorLayers","layers","visible","radioContainerApCs","filters","containerBodyApCs","filter","select","id","codeField","startupData","urlFilter","url","fieldsFilter","nameField","getDataByFilter","then","response","features","$","prop","makeOptionCs","firstOption","catch","console","error","err","event","onChangeFilterCs","tags","placeholder","fields","where","distinctValues","deferred","queryTask","outFields","returnGeometry","returnDistinctValues","execute","resolve","reject","promise","setExtentByFilter","self","executeForExtent","expand","destroyFormRadioCs","options","selectControl","valueField","labelField","fixOptionSelected","selectedValue","selectedIndex","value","phOption","text","restoreOption","selected","optionElement","option","attributes","toString","currentFilterIndex","show","manageWhere","currentFilter","currentTarget","dispatchEvent","Event","responseFilter","isZoom","geometry","centerAndZoom","Error","labelLayerSelected","y","promises","data","getElementById","hide","formRadioContainersApCs","idSelected","radioItemContainer","input","layer","for","display","handleRadioButtonClick","checked","click","layerSelected","layersId","getLayer","layerId","setVisibility","push","join"],"mappings":"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","file":"Widget.js","sourcesContent":["import declare from 'dojo/_base/declare';\r\nimport BaseWidget from 'jimu/BaseWidget';\r\nimport _WidgetsInTemplateMixin from 'dijit/_WidgetsInTemplateMixin';\r\nimport WidgetManager from \"jimu/WidgetManager\"\r\nimport QueryTask from \"esri/tasks/QueryTask\";\r\nimport Query from \"esri/tasks/query\";\r\nimport Deferred from \"dojo/Deferred\";\r\nimport all from \"dojo/promise/all\";\r\nimport BusyIndicator from 'esri/dijit/util/busyIndicator';\r\nimport Message from \"jimu/dijit/Message\";\r\nimport jquery from 'https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js';\r\nimport select2 from 'https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/js/select2.min.js';\r\n\r\nconst fontAwesome = document.createElement('script');\r\nfontAwesome.src = 'https://use.fontawesome.com/releases/v5.3.1/js/all.js';\r\ndocument.head.appendChild(fontAwesome);\r\n\r\nconst select2Css = document.createElement('link');\r\nselect2Css.rel = 'stylesheet';\r\nselect2Css.href = 'https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/css/select2.min.css';\r\ndocument.head.appendChild(select2Css);\r\n\r\nlet isFirstLoad = false;\r\n\r\n// To create a widget, you need to derive from BaseWidget.\r\nexport default declare([BaseWidget], {\r\n\r\n  // Custom widget code goes here\r\n\r\n  baseClass: 'dynamic-search-widget-cuna-mas',\r\n  groupSelected: null,\r\n  urlLayerSelected: null,\r\n  whereDefault: '1=1',\r\n\r\n  // add additional properties here\r\n\r\n  // methods to communication with app container:\r\n  postCreate() {\r\n    this.inherited(arguments);\r\n    this.map.on(\"update-end\", this.executeZoomExtentInitial.bind(this));\r\n  },\r\n\r\n  showMessageCs(message, type = 'message') {\r\n    const title = `${this.nls.widgetTitle}`;\r\n    new Message({\r\n      type: type,\r\n      titleLabel: title,\r\n      message: message,\r\n    });\r\n  },\r\n\r\n  onClickGroup(evt) {\r\n    const indexGroupSelected = Array.from(evt.target.parentNode.children).indexOf(evt.target);\r\n    this.groupSelected = this.config.groups.find(group => group.index === indexGroupSelected);\r\n    this.buildFormRadioCs();\r\n    this.buildFormSearchCs();\r\n    this.buildHeaderSearchCs();\r\n    this.containerGroupsApCs.classList.toggle('active');\r\n    this.containerFiltersApCs.classList.toggle('active');\r\n  },\r\n\r\n  onClickBack(evt) {\r\n    this.containerGroupsApCs.classList.toggle('active');\r\n    this.containerFiltersApCs.classList.toggle('active');\r\n    this.destroyFormSearchCs();\r\n    this.urlLayerSelected = null;\r\n  },\r\n\r\n  startup() {\r\n    this.inherited(arguments);\r\n    this.busyIndicator = BusyIndicator.create({\r\n      target: this.domNode.parentNode.parentNode,\r\n      backgroundOpacity: 0\r\n    });\r\n  },\r\n  onOpen() {\r\n    this.buildMainMenuCs();\r\n    dojo.query(\".groupFilterClsCs\").on('click', this.onClickGroup.bind(this));\r\n    dojo.query(\".backButtonClsCs\").on('click', this.onClickBack.bind(this));\r\n  },\r\n\r\n  executeZoomExtentInitial() {\r\n    if (isFirstLoad) {\r\n      return;\r\n    }\r\n    const homeWidget = WidgetManager.getInstance().getWidgetsByName(\"HomeButton\");\r\n    this.map.setExtent(homeWidget[0].homeDijit.extent);\r\n    isFirstLoad = true;\r\n  },\r\n\r\n  buildMainMenuCs() {\r\n    this.config.groups.sort((a, b) => a.index - b.index);\r\n    this.containerGridApCs.innerHTML = '';\r\n    if (this.config.groups.length == 1) {\r\n      this.groupSelected = this.config.groups[0];\r\n      this.containerBackApCs.classList.remove('active');\r\n      this.buildFormRadioCs();\r\n      this.buildFormSearchCs();\r\n      this.buildHeaderSearchCs();\r\n      this.containerGroupsApCs.classList.toggle('active');\r\n      this.containerFiltersApCs.classList.toggle('active');\r\n      return;\r\n    }\r\n    this.config.groups.forEach(group => {\r\n      const img = document.createElement('img');\r\n      img.src = group.logo;\r\n      img.alt = group.name;\r\n      img.classList.add('groupFilterClsCs', 'groupCs');\r\n      img.setAttribute('data-dojo-attach-point', 'scdApCs');\r\n      this.containerGridApCs.appendChild(img);\r\n    });\r\n  },\r\n\r\n  buildHeaderSearchCs() {\r\n    dojo.query('#nameSelectedCs')[0].innerHTML = this.groupSelected.label;\r\n    dojo.query('#nameSelectedCs')[0].style.color = this.groupSelected.color;\r\n    dojo.query('#descSelectedCs')[0].innerHTML = this.groupSelected.description;\r\n    dojo.query('#descSelectedCs')[0].style.color = this.groupSelected.color;\r\n    const img = document.createElement('img');\r\n    img.src = this.groupSelected.logo;\r\n    img.alt = this.groupSelected.name;\r\n    img.classList.add('groupFilterClsCs', 'groupCs');\r\n    img.setAttribute('data-dojo-attach-point', 'scdApCs');\r\n    this.containerImgSelectedApCs.innerHTML = '';\r\n    this.containerImgSelectedApCs.appendChild(img);\r\n  },\r\n\r\n  buildFormRadioCs() {\r\n    if (this.groupSelected.layersForm) {\r\n      this.makeSelectorLayers(this.groupSelected.layersForm.layers);\r\n      if (this.groupSelected.layersForm.visible) {\r\n        this.radioContainerApCs.classList.add('active');\r\n      } else {\r\n        this.radioContainerApCs.classList.remove('active');\r\n      }\r\n    } else {\r\n      this.radioContainerApCs.classList.remove('active');\r\n    }\r\n  },\r\n\r\n  buildFormSearchCs() {\r\n    const filters = this.groupSelected.filters;\r\n    filters.sort((a, b) => a.index - b.index);\r\n    this.containerBodyApCs.innerHTML = '';\r\n    filters.forEach((filter, index) => {\r\n      const label = document.createElement('p');\r\n      label.classList.add('labelComboBoxClsCs');\r\n      label.innerHTML = filter.label;\r\n      this.containerBodyApCs.appendChild(label);\r\n\r\n      const select = document.createElement('select');\r\n      select.classList.add('comboBoxClsCs');\r\n      select.classList.add('form-control');\r\n      select.classList.add('js-example-tags');\r\n      // select.classList.add('select2');\r\n      select.id = filter.codeField;\r\n      if (filter.startupData) {\r\n        const urlFilter = this.urlLayerSelected || filter.url;\r\n        const fieldsFilter = [filter.codeField, filter.nameField];\r\n        this.getDataByFilter(urlFilter, fieldsFilter)\r\n          .then(response => {\r\n            if (response.features.length === 1000) {\r\n              // disable select\r\n              $(`#${filter.codeField}`).prop(\"disabled\", true);\r\n            } else {\r\n              $(`#${filter.codeField}`).prop(\"disabled\", false);\r\n              this.makeOptionCs(response.features, select, filter.codeField, filter.nameField, filter.firstOption);\r\n            }\r\n          })\r\n          .catch(err => {\r\n            console.error('err', err);\r\n          });\r\n\r\n      };\r\n      // select.select2({\r\n      //   tags: true,\r\n      //   onchange: this.onChangeFilterCs.bind(this)\r\n      // })\r\n      // select.addEventListener('change.select2', (event) => this.onChangeFilterCs(event, index));\r\n      // the same code as js vanilla with jquery\r\n      this.containerBodyApCs.appendChild(select);\r\n      $(`#${filter.codeField}`).on('select2:select', (event) => this.onChangeFilterCs(event, index));\r\n      $(`#${filter.codeField}`).select2({\r\n        tags: true,\r\n        placeholder: filter.firstOption,\r\n        // allowClear: true\r\n      });\r\n\r\n    });\r\n\r\n  },\r\n\r\n  getDataByFilter(url, fields, where = this.whereDefault, distinctValues = true) {\r\n    const deferred = new Deferred();\r\n    const queryTask = new QueryTask(url);\r\n    const query = new Query();\r\n    query.outFields = fields;\r\n    query.where = where;\r\n\r\n    query.returnGeometry = distinctValues ? false : true;\r\n    query.returnDistinctValues = distinctValues;\r\n\r\n    queryTask.execute(query)\r\n      .then(response => {\r\n        deferred.resolve(response);\r\n      })\r\n      .catch(err => {\r\n        deferred.reject(err);\r\n      });\r\n    return deferred.promise;\r\n  },\r\n\r\n  setExtentByFilter(url, where) {\r\n    const self = this;\r\n    const deferred = new Deferred();\r\n    const queryTask = new QueryTask(url);\r\n    const query = new Query();\r\n    query.where = where;\r\n    query.returnGeometry = true;\r\n\r\n    queryTask.executeForExtent(query)\r\n      .then(response => {\r\n        self.map.setExtent(response.extent.expand(1.1), true);\r\n        deferred.resolve(response);\r\n      })\r\n      .catch(err => {\r\n        console.error('err', err);\r\n        deferred.reject(err);\r\n      });\r\n    return deferred.promise;\r\n  },\r\n\r\n  destroyFormSearchCs() {\r\n    this.containerBodyApCs.innerHTML = '';\r\n  },\r\n\r\n  destroyFormRadioCs() {\r\n    this.radioContainerApCs.innerHTML = '';\r\n  },\r\n\r\n  makeOptionCs(options, selectControl, valueField, labelField, firstOption, fixOptionSelected = true) {\r\n    let selectedValue = null;\r\n    if (fixOptionSelected) {\r\n      const selectedIndex = selectControl.selectedIndex;\r\n      if (selectedIndex > 1) {\r\n        selectedValue = selectControl.options[selectedIndex].value;\r\n      }\r\n    }\r\n    selectControl.innerHTML = '';\r\n    const phOption = document.createElement('option');\r\n    phOption.text = firstOption;\r\n    phOption.value = '';\r\n    selectControl.appendChild(phOption);\r\n\r\n    const restoreOption = document.createElement('option');\r\n    // restoreOption.text = firstOption;\r\n    restoreOption.text = 'Vacío';\r\n    restoreOption.value = '0';\r\n    restoreOption.selected = false;\r\n    // restoreOption.disabled = true;\r\n    selectControl.appendChild(restoreOption);\r\n\r\n    options.forEach(option => {\r\n      const optionElement = document.createElement('option');\r\n      optionElement.value = option.attributes[valueField];\r\n      optionElement.innerHTML = option.attributes[labelField];\r\n      if (selectedValue && selectedValue.toString() === option.attributes[valueField].toString()) {\r\n        optionElement.selected = true;\r\n      }\r\n      selectControl.appendChild(optionElement);\r\n    });\r\n  },\r\n\r\n  onChangeFilterCs(evt, currentFilterIndex) {\r\n    this.busyIndicator.show();\r\n    let where = this.manageWhere();\r\n    if (where === '') {\r\n      where = this.whereDefault;\r\n    }\r\n    const selectedIndex = evt.target.selectedIndex;\r\n    const selectedValue = evt.target.options[selectedIndex].value;\r\n    const currentFilter = this.groupSelected.filters[currentFilterIndex];\r\n\r\n    if (selectedValue === '0') {\r\n      // si se selecionar \"vacio\" con un value igual a 0; el select no debe tener ningun valor seleccionado\r\n      evt.currentTarget.value = '';\r\n      // evt.currentTarget.options[0].selected = true;\r\n      evt.currentTarget.dispatchEvent(new Event('change'));\r\n    };\r\n\r\n    const fields = [currentFilter.codeField, currentFilter.nameField];\r\n    // const where = `${currentFilter.codeField} = '${selectedValue}'`;\r\n\r\n    let responseFilter;\r\n\r\n    const url = this.urlLayerSelected || currentFilter.url;\r\n    return this.getDataByFilter(url, fields, where, false)\r\n      .then((response) => {\r\n        responseFilter = response;\r\n        if (!currentFilter.isZoom) {\r\n          return null;\r\n        }\r\n        if (responseFilter.features.length === 1 && responseFilter.features[0].geometry.type === 'point') {\r\n          return this.map.centerAndZoom(responseFilter.features[0].geometry, 17);\r\n        }\r\n        if (responseFilter.features.length === 0) {\r\n          throw new Error(`No se encontraron resultados de ${this.labelLayerSelected} en esta ubicación`);\r\n          // console.log(\"No se encontraron resultados\");\r\n          // return;\r\n        }\r\n        return this.setExtentByFilter(url, where); y\r\n      })\r\n      .then(() => {\r\n        if (responseFilter.features.length === 0) {\r\n          return;\r\n        }\r\n        const promises = this.groupSelected.filters.map((filter, index) => {\r\n          if (selectedValue === '0') {\r\n            const urlFilter = this.urlLayerSelected || filter.url;\r\n            const fieldsFilter = [filter.codeField, filter.nameField];\r\n            return this.getDataByFilter(urlFilter, fieldsFilter, where)\r\n              .then(data => {\r\n                if (data.features.length === 1000) {\r\n                  // disable select\r\n                  $(`#${filter.codeField}`).prop(\"disabled\", true);\r\n                } else {\r\n                  $(`#${filter.codeField}`).prop(\"disabled\", false);\r\n                  this.makeOptionCs(data.features, document.getElementById(filter.codeField), filter.codeField, filter.nameField, filter.firstOption);\r\n                }\r\n\r\n              });\r\n          }\r\n          else if (evt.target.id !== filter.codeField) {\r\n            const urlFilter = this.urlLayerSelected || filter.url;\r\n            const fieldsFilter = [filter.codeField, filter.nameField];\r\n            return this.getDataByFilter(urlFilter, fieldsFilter, where)\r\n              .then(data => {\r\n                if (data.features.length === 1000) {\r\n                  // disable select\r\n                  $(`#${filter.codeField}`).prop(\"disabled\", true);\r\n                } else {\r\n                  $(`#${filter.codeField}`).prop(\"disabled\", false);\r\n                  this.makeOptionCs(data.features, document.getElementById(filter.codeField), filter.codeField, filter.nameField, filter.firstOption);\r\n                }\r\n              });\r\n          }\r\n        });\r\n        return all(promises);\r\n        // this.groupSelected.filters.forEach(filter => {\r\n        // makeOption by each filter\r\n\r\n        // });\r\n        //   if (!currentFilter.filterAffected) {\r\n        //     return;\r\n        //   }\r\n        //   currentFilter.filterAffected.forEach(affectedIndex => {\r\n        //     const affectedFilter = this.groupSelected.filters[affectedIndex];\r\n        //     const affectedSelect = document.getElementById(affectedFilter.codeField);\r\n        //     const urlFilter = this.urlLayerSelected || affectedFilter.url;\r\n        //     const fieldsFilter = [affectedFilter.codeField, affectedFilter.nameField];\r\n        //     const whereFilter = `${currentFilter.codeField} = '${selectedValue}'`;\r\n        //     this.getDataByFilter(urlFilter, fieldsFilter, whereFilter)\r\n        //       .then(data => {\r\n        //         this.makeOptionCs(data.features, affectedSelect, affectedFilter.codeField, affectedFilter.nameField, affectedFilter.firstOption);\r\n        //       })\r\n        //       .then(() => {\r\n        //         let filterAffectedReset = affectedFilter.filterAffected;\r\n        //         while (filterAffectedReset.length > 0) {\r\n        //           filterAffectedReset = this.resetSelectIndexArray(filterAffectedReset);\r\n        //         }\r\n        //       })\r\n        //       .catch(err => {\r\n        //         console.error(`Error al actualizar el filtro ${affectedFilter.label}:`, err);\r\n        //       });\r\n        //   });\r\n      })\r\n      .then(() => {\r\n        this.busyIndicator.hide();\r\n      })\r\n      .catch(err => {\r\n        this.showMessageCs(err.message, 'error');\r\n        // console.error('err', err);\r\n        this.busyIndicator.hide();\r\n      });\r\n  },\r\n\r\n  // resetSelectIndexArray(indexArray) {\r\n  //   const newAffectedFilters = [];\r\n  //   this.groupSelected.filters.forEach(filter => {\r\n  //     indexArray.forEach(index => {\r\n  //       if (filter.index === index) {\r\n  //         const select = document.getElementById(filter.codeField);\r\n  //         select.innerHTML = '';\r\n  //         const phOption = document.createElement('option');\r\n  //         phOption.text = filter.firstOption;\r\n  //         phOption.value = '';\r\n  //         select.appendChild(phOption);\r\n  //         const restoreOption = document.createElement('option');\r\n  //         // restoreOption.text = filter.firstOption;\r\n  //         restoreOption.text = 'Vacío';\r\n  //         restoreOption.value = '0';\r\n  //         restoreOption.selected = false;\r\n  //         // restoreOption.disabled = false;\r\n  //         select.appendChild(restoreOption);\r\n  //         newAffectedFilters.push(filter.filterAffected);\r\n  //       }\r\n  //     });\r\n  //   });\r\n\r\n  //   return newAffectedFilters.flat();\r\n  // },\r\n\r\n  makeSelectorLayers(layers) {\r\n    layers.sort((a, b) => a.index - b.index);\r\n    this.formRadioContainersApCs.innerHTML = '';\r\n\r\n    let idSelected;\r\n\r\n    layers.forEach(layer => {\r\n\r\n      const radioItemContainer = document.createElement('div');\r\n      radioItemContainer.classList.add('radioItemContainerCs');\r\n      const input = document.createElement('input');\r\n      input.type = 'radio';\r\n      input.name = 'searchType';\r\n      input.id = layer.id;\r\n      if (layer.selected) {\r\n        idSelected = layer.id;\r\n      };\r\n      radioItemContainer.appendChild(input);\r\n      const label = document.createElement('label');\r\n      label.for = layer.id;\r\n      label.innerHTML = layer.label;\r\n      radioItemContainer.appendChild(label);\r\n      if (!layer.visible) {\r\n        // display none\r\n        radioItemContainer.style.display = 'none';\r\n      }\r\n      this.formRadioContainersApCs.appendChild(radioItemContainer);\r\n    });\r\n    dojo.query('.radioItemContainerCs input').on('click', this.handleRadioButtonClick.bind(this));\r\n    // execute event ckecked the radio button selected by id programmatically in dom\r\n    if (idSelected) {\r\n      document.getElementById(idSelected).checked = true;\r\n      document.getElementById(idSelected).click();\r\n    };\r\n  },\r\n\r\n  handleRadioButtonClick(event) {\r\n    const layerSelected = this.groupSelected.layersForm.layers.find(layer => layer.id === event.target.id);\r\n    if (layerSelected) {\r\n      this.groupSelected.layersForm.layers.forEach(layer => {\r\n        if (layer.id === event.target.id) {\r\n        } else {\r\n          layer.layersId.forEach(layerId => {\r\n            if (this.map.getLayer(layerId).visible & layerSelected.layersId[0] != layerId) {\r\n              this.map.getLayer(layerId).setVisibility(false)\r\n            };\r\n          });\r\n        }\r\n      });\r\n      layerSelected.layersId.forEach(layerId => {\r\n        if (!this.map.getLayer(layerId).visible) {\r\n          this.map.getLayer(layerId).setVisibility(true);\r\n        };\r\n      });\r\n      this.urlLayerSelected = this.map.getLayer(layerSelected.layersId[0]).url;\r\n      this.labelLayerSelected = layerSelected.label;\r\n    }\r\n  },\r\n\r\n  manageWhere() {\r\n    let where = [];\r\n    this.groupSelected.filters.forEach(filter => {\r\n      const select = document.getElementById(filter.codeField);\r\n      // get value selected\r\n      const selectedIndex = select.selectedIndex;\r\n      if (selectedIndex > 1) {\r\n        // create where\r\n        const selectedValue = select.options[selectedIndex].value;\r\n        where.push(`(${filter.codeField} = '${selectedValue}')`);\r\n      };\r\n    });\r\n    // console.log('where', where.join(' AND '));\r\n    return where.join(' AND ');\r\n  },\r\n\r\n\r\n\r\n  // onClose(){\r\n  //   console.log('DynamicSearchWidgetCunaMas::onClose');\r\n  // },\r\n  // onMinimize(){\r\n  //   console.log('DynamicSearchWidgetCunaMas::onMinimize');\r\n  // },\r\n  // onMaximize(){\r\n  //   console.log('DynamicSearchWidgetCunaMas::onMaximize');\r\n  // },\r\n  // onSignIn(credential){\r\n  //   console.log('DynamicSearchWidgetCunaMas::onSignIn', credential);\r\n  // },\r\n  // onSignOut(){\r\n  //   console.log('DynamicSearchWidgetCunaMas::onSignOut');\r\n  // }\r\n  // onPositionChange(){\r\n  //   console.log('DynamicSearchWidgetCunaMas::onPositionChange');\r\n  // },\r\n  // resize(){\r\n  //   console.log('DynamicSearchWidgetCunaMas::resize');\r\n  // }\r\n});\r\n"]}